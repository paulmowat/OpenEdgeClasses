 
 /*------------------------------------------------------------------------
    File        : sha256
    Purpose     : 
    Syntax      : 
    Description : Converts text to a SH256 encoded value.
    Author(s)   : paul.mowat
    Created     : Tue Nov 27 09:41:57 GMT 2012
    Notes       : Not introduced into core Progress until V11
        
    text: mynameispaul
    
    hex   : cd88a8935f9ca75092a58b16defc47b490b09067c1dde63ff346ee0f8b31c729
    base64: zYiok1+cp1CSpYsW3vxHtJCwkGfB3eY/80buD4sxxyk=      
        
  ----------------------------------------------------------------------*/

USING Progress.Lang.*.
USING System.Security.Cryptography.*.
USING System.Text.*.

ROUTINE-LEVEL ON ERROR UNDO, THROW.

CLASS abl.cryptography.sha256: 
  
	/*------------------------------------------------------------------------------
    Purpose:  Conversts a string into a SHA256 code																  
		Notes:  																	  
	------------------------------------------------------------------------------*/		
				
  /*------------------------------------------------------------------------------
    Purpose: Calculates Hash and stores as a byte array 																  
		Notes:  																	  
	------------------------------------------------------------------------------*/	
				
	CONSTRUCTOR PUBLIC sha256 ( ):
		SUPER ().		
           		
	END CONSTRUCTOR.

  
  /*------------------------------------------------------------------------------
    Purpose: Converts byte array into Hex string                                                                
    Notes:                                                                        
  ------------------------------------------------------------------------------*/
  
  METHOD PUBLIC CHARACTER ConvertToHex( INPUT ip_cTextToHash AS CHARACTER ):
      
      DEFINE VARIABLE lv_bText          AS "System.Byte[]" NO-UNDO.
      DEFINE VARIABLE lv_bHashedBytes   AS "System.Byte[]" NO-UNDO. 
      DEFINE VARIABLE lv_oSHA256Managed AS SHA256Managed NO-UNDO.
      
      ASSIGN lv_oSHA256Managed = NEW SHA256Managed()
             lv_bText          = System.Text.Encoding:UTF8:GetBytes(ip_cTextToHash)
             lv_bHashedBytes   = lv_oSHA256Managed:ComputeHash(lv_bText).
      
      DEFINE VARIABLE lv_oStringBuilder AS StringBuilder NO-UNDO.
      DEFINE VARIABLE lv_oHashedBytesEnumerator AS System.Collections.IEnumerator NO-UNDO.
                      
      ASSIGN lv_oStringBuilder         = NEW StringBuilder()
             lv_oHashedBytesEnumerator = lv_bHashedBytes:GetEnumerator().                             
  
      lv_oHashedBytesEnumerator:Reset().
      
      DO WHILE lv_oHashedBytesEnumerator:MoveNext() ON ERROR UNDO, THROW:
          lv_oStringBuilder:AppendFormat("昂猖昧釉祧唢柔箬邃蛮翦笈铛礤蜥麸蚝悯蝌孱衄⒂篝屙蛮翦┅盼漠遗哉椅祧唢郁蜷铉迈殪溴蚝燥郁蜷铉ī盼团匀夏絮蝠矬搴蔑铞弪趔怡翦狎蜥轭麸忉箦洞篝蜷铉物翦蠛团匀夏姓绿擅萌烈撩耘蔑铞弪粼锫狍宥川晌姓轲咩藻粼锶狍劣萌烈撩耘┖呐粕闻至疑谅膛祧哜藻劣⒂篝屙蛮翦圯蜗瘴南呐粕闻至疑谅膛祧哜柔箬邃蛮翦劣⒂篝屙蛮翦圯蜗瘴南呐粕闻至疑谅膛祧唢尤敛刀歪钺珏劣尤敛刀歪钺珏蜗瘴南劣由俏祧唢尤敛刀歪钺珏闻尤敛刀歪钺珏洙祧哜藻御篝屙藻舢蓬泔溟铉赫云负清袈翦蟥轲咩藻粼锶狍瑭祧哜柔箬邃蛮翦祧唢尤敛刀歪钺珏浜蔑眇豸迦狍瑷祧哜藻舂遗哉椅御篝屙蔑铞弪艉燥箩箦洞郁蜷铉祧哜柔箬邃蛮翦螬盼团匀夏盼锰劣赢